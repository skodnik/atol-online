![workflow](https://github.com/skodnik/atol-online/actions/workflows/main.yml/badge.svg)

# Http клиент для работы с API АТОЛ Онлайн. 54–ФЗ.

## Уведомление

Основано на ["Описание протокола"](docs/API_atol_online_v4.pdf) Версия сервиса v4 ([ФФД 1.05](https://www.consultant.ru/document/cons_doc_LAW_362322/8127e844073d6b2199579047516a85e4e3b7014a/)), Версия документа 5.15.

## Преимущества

- Получение, сохранение, удаление, обновление токена происходит автоматически.
- Возможность кеширования токена с помощью класса кеша
  имплементирующего [PSR-16: Common Interface for Caching Libraries](https://www.php-fig.org/psr/psr-16/).
- Простой класс кеша реализован библиотекой, при желании можно использовать кеширование Laravel, например.
- Клиент API Атол может принимать любой http-клиент
  реализующий [PSR-18: HTTP Client](https://www.php-fig.org/psr/psr-18/).
- Расчет налоговых ставок по позициям чека можно выполнять автоматически или принудительно.
- Расчет итоговой суммы по позициям чека можно выполнять автоматически или принудительно.
- В целях облегчения отладки, в режиме `debug`, библиотекой формируются файлы запросов для IDE PhpStorm, ответы при
  выполнении интеграционных тестов логгируются.

## Установка

```shell
composer require vlsv/atol-online
```

## Использование

1. [Инициализация клиента](docs/client-initialization.md)
2. [Кеширование](docs/caching.md)
3. [Авторизация пользователя](docs/user-authorization.md)
4. [Регистрация документа](docs/document-registration.md)
5. [Получение результата обработки документа](docs/report.md)
6. [Debug](docs/debug.md)

Больше примеров использования в тестах.

## Тесты

```shell
composer tests
```

## Разное

[Ошибки при работе с ККТ](docs/kkt-errors.csv)

## Лицензия

[GNU General Public License v3](LICENSE)

## Отказ от ответственности

Автор не несет ответственности за какие-либо претензии, убытки или другие обязательства, возникшие или возникающие в
результате использования, распространения или других видов обращения с данным программным обеспечением.
